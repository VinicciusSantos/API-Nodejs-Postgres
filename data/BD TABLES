CREATE TABLE projetos(
    "id_projeto" SERIAL NOT NULL PRIMARY KEY,
    "nome" VARCHAR NOT NULL
);

CREATE TABLE equipes(
    "id_equipe" SERIAL NOT NULL PRIMARY KEY,
    "nome" VARCHAR NOT NULL,
    "id_projeto" INT NOT NULL,
    FOREIGN KEY ("id_projeto") REFERENCES projetos("id_projeto")
);

CREATE TABLE tarefas(
    "id_tarefa" SERIAL NOT NULL PRIMARY KEY,
    "nome" VARCHAR NOT NULL,
    "descricao" VARCHAR NOT NULL
);

CREATE TABLE pessoas(
    "id_pessoa" SERIAL NOT NULL PRIMARY KEY,
    "nome" VARCHAR NOT NULL,
    "profissao" VARCHAR NOT NULL,
    "id_equipe" INT NOT NULL,
    "id_tarefa" INT NOT NULL,
    FOREIGN KEY ("id_equipe") REFERENCES equipes("id_equipe"),
    FOREIGN KEY ("id_tarefa") REFERENCES tarefas("id_tarefa")
);

/* LÃ³gico: */

CREATE TABLE projetos (
    id SERIAL PRIMARY KEY NOT NULL,
    nome VARCHAR(30) NOT NULL,
    descricao VARCHAR(200),
    data_criacao DATE
);

CREATE TABLE equipes (
    id SERIAL PRIMARY KEY NOT NULL,
    nome VARCHAR(30) NOT NULL,
    fk_projetos_id int,
    fk_lider int
);

CREATE TABLE pessoas (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(30) NOT NULL,
    profissao VARCHAR(30),
    data_nasc DATE,
    fk_tarefa int
);

CREATE TABLE tarefas (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(30) NOT NULL,
    descricao VARCHAR(200),
    data_criacao DATE
);

CREATE TABLE possuem_projetos_tarefas (
    id SERIAL PRIMARY KEY NOT NULL
    fk_projetos int NOT NULL,
    fk_tarefas int NOT NULL,
);

CREATE TABLE pertencem_pessoas_equipes (
    fk_pessoas_id int NOT NULL,
    fk_equipes_id int NOT NULL
);
 
ALTER TABLE equipes ADD CONSTRAINT FK_equipes_2
    FOREIGN KEY (fk_projetos_id)
    REFERENCES projetos (id)
    ON DELETE SET NULL;
 
ALTER TABLE equipes ADD CONSTRAINT FK_equipes_3
    FOREIGN KEY (fk_lider)
    REFERENCES equipes (id);
 
ALTER TABLE equipes ADD CONSTRAINT FK_equipes_4
    FOREIGN KEY (fk_lider)
    REFERENCES pessoas (id);
 
ALTER TABLE pessoas ADD CONSTRAINT FK_pessoas_2
    FOREIGN KEY (fk_tarefa)
    REFERENCES possuem_projetos_tarefas (id);
 
ALTER TABLE possuem_projetos_tarefas ADD CONSTRAINT FK_possuem_projetos_tarefas_1
    FOREIGN KEY (fk_projetos)
    REFERENCES projetos (id)
    ON DELETE NO ACTION;
 
ALTER TABLE possuem_projetos_tarefas ADD CONSTRAINT FK_possuem_projetos_tarefas_2
    FOREIGN KEY (fk_tarefas)
    REFERENCES tarefas (id)
    ON DELETE NO ACTION;
 
ALTER TABLE pertencem_pessoas_equipes ADD CONSTRAINT FK_pertencem_pessoas_equipes_1
    FOREIGN KEY (fk_pessoas_id)
    REFERENCES pessoas (id)
    ON DELETE SET NULL;
 
ALTER TABLE pertencem_pessoas_equipes ADD CONSTRAINT FK_pertencem_pessoas_equipes_2
    FOREIGN KEY (fk_equipes_id)
    REFERENCES equipes (id)
    ON DELETE SET NULL;
